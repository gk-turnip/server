{{define "head"}}
<head>
	<title>{{.Title}}</title>
	<meta http-equiv="content-type" 
		content="text/html;charset=utf-8" />

	<link rel="stylesheet" type="text/css" 
		href="/assets/gk/stylesheets/login/login.css" title="default"/>

	<link rel="alternate stylesheet" type="text/css" 
		href="/assets/gk/stylesheets/login/login_thin.css" title="thin"/>
	<link rel="alternate stylesheet" type="text/css" 
		href="/assets/gk/stylesheets/login/login_normal.css" title="normal"/>
	<link rel="alternate stylesheet" type="text/css" 
		href="/assets/gk/stylesheets/login/login_wide.css" title="wide"/>

	<script src="{{.WebAddressPrefix}}/assets/gk/javascript/dynamiclayout.js" type="text/javascript"></script>
	<script src="{{.WebAddressPrefix}}/assets/gk/javascript/game/gkRain.js" type="text/javascript"></script>
	<script src="{{.WebAddressPrefix}}/assets/gk/javascript/game/gkIso.js" type="text/javascript"></script>
	<script src="{{.WebAddressPrefix}}/assets/gk/javascript/game/gkWs.js" type="text/javascript"></script>
	<script src="{{.WebAddressPrefix}}/assets/gk/javascript/game/gkAudio.js" type="text/javascript"></script>
	<script src="{{.WebAddressPrefix}}/assets/gk/javascript/game/gkTerrain.js" type="text/javascript"></script>
	<script src="{{.WebAddressPrefix}}/assets/gk/javascript/game/gkField.js" type="text/javascript"></script>
	<script src="{{.WebAddressPrefix}}/assets/gk/javascript/game/gkDispatch.js" type="text/javascript"></script>

	<script type="text/javascript">
		var loaded;
		var mode;
		function init() {
			console.log("calling init");

			scriptUse = document.getElementById("scriptUse");
			var loader = document.createTextNode("Loaded!");
			var loaded = scriptUse.appendChild(loader);
			var loader;
			
			var s1
			s1 = document.getElementById("selectAvatar");
			s1.selectedIndex = 0;
			s1 = document.getElementById("volume1");
			s1.selectedIndex = 1;
			s1 = document.getElementById("volume2");
			s1.selectedIndex = 1;

			gkWsInit(gkDispatchWsMessage, "{{.WebsocketAddressPrefix}}", "{{.WebsocketPath}}", "{{.SessionId}}");

			//gkIsoDrawGridDiamond();
			//gkRenderMap(Math.floor(Math.random() * 5), 55);

			gkRainStart();

			gkAudioInit("{{.AudioAddressPrefix}}");
			var canPlay = document.getElementById("canPlay");
			if (gkAudioContext.canPlayWav) {
				canPlay.innerHTML += " .wav";
			}
			if (gkAudioContext.canPlayMp3) {
				canPlay.innerHTML += " .mp3";
			}
			if (gkAudioContext.canPlayOgg) {
				canPlay.innerHTML += " .ogg";
			}
			gkAudioStartAudio(1, "Underwater2");
			gkAudioStartAudio(3, "Rain");
			var rainTBP = document.getElementById("audio3");
			rainTBP.pause();
			var rainTBP;

			gkTerrainInit(5);
			//gkAvatarInit();
			gkFieldInit();

		}

		function doClick(e) {
			var x, y

			x = e.pageX - GK_SVG_MARGIN_X;
			y = e.pageY - GK_SVG_MARGIN_Y;

			var winXY;

			winXY = new GkWinXYDef(x,y);
			//gkAvatarSetNewDestination(winXY.convertToIso(0));

			gkFieldSetNewAvatarDestination(winXY.convertToIso(0));

			gkAudioStartAudio(2, "boing");
		}

		function changeAvatar() {
			avatarName = document.getElementById("selectAvatar").value;
			console.log("avatarName: " + avatarName)
			//gkAvatarLoadNewAvatar(avatarName);
			gkFieldLoadNewAvatar(avatarName);
		}

		function volumeChange(volumeId) {
			volumeSelect = document.getElementById("volume" + volumeId);
			value = volumeSelect.options[volumeSelect.selectedIndex].value
			gkAudioVolumeChange(volumeId, value);
		}

	</script>
</head>
{{end}}
